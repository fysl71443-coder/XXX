# ๐ง ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงููุงูู - ุฏููู ุดุงูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุณูุฑูุจุช ูููู ุจุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงููุงูู ููุธุงู POS ุนูู PostgreSQL. ูููู ุจู:

1. โ ุฅูุดุงุก ุฌููุน ุงูุฌุฏุงูู ุงููุงูุตุฉ
2. โ ุฅุถุงูุฉ ุงูุฃุนูุฏุฉ ุงููุงูุตุฉ
3. โ ุฅูุดุงุก ุงูุญุณุงุจุงุช ุงูุฃุณุงุณูุฉ
4. โ ุฅุถุงูุฉ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
5. โ ุงูุชุญูู ูู ุณูุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ ุงูุงุณุชุฎุฏุงู

### ุงูุทุฑููุฉ 1: ุงุณุชุฎุฏุงู ุณูุฑูุจุช Node.js (ูููุตู ุจู)

```bash
cd backend/scripts
node fix_complete_database.js
```

### ุงูุทุฑููุฉ 2: ุงุณุชุฎุฏุงู SQL ูุจุงุดุฑุฉ

```bash
psql "postgresql://china_town_db_czwv_user:Z3avbH9Vxfdb3CnRVHmF7hDTkhjBuRla@dpg-d5hsjmali9vc73am1v60-a/china_town_db_czwv" -f fix_complete_database.sql
```

## ๐ ูุง ูุชู ุฅุตูุงุญู

### 1๏ธโฃ ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ

- **`branch_accounts`**: ุญุณุงุจุงุช ุงููุฑูุน (ูุจูุนุงุชุ ูุฏููุนุงุชุ ุถุฑูุจุฉ)
- **`pos_tables`**: ุทุงููุงุช POS (ุญุงูุฉ ุงูุทุงููุฉุ ุงูุทูุจ ุงูุญุงูู)
- **`order_drafts`**: ูุณูุฏุงุช ุงูุทูุจุงุช (ูููุณุฎ ุงูุงุญุชูุงุทู)

### 2๏ธโฃ ุงูุฃุนูุฏุฉ ุงููุถุงูุฉ

- **`invoices.journal_entry_id`**: ุฑุจุท ุงูููุงุชูุฑ ุจุงููููุฏ ุงููุญุงุณุจูุฉ
- **`invoices.closed_at`**: ุชุงุฑูุฎ ุฅุบูุงู ุงููุงุชูุฑุฉ
- **`orders.closed_at`**: ุชุงุฑูุฎ ุฅุบูุงู ุงูุทูุจ
- **`journal_entries.branch`**: ุงููุฑุน ููููุฏ ุงููุญุงุณุจู
- **`accounts.account_code`**: ุฑูุฒ ุงูุญุณุงุจ (ููุชูุงูู)

### 3๏ธโฃ ุงูุญุณุงุจุงุช ุงูุฃุณุงุณูุฉ

| ุฑูู ุงูุญุณุงุจ | ุงูุงุณู | ุงูููุน | ุงูุทุจูุนุฉ |
|------------|-------|-------|---------|
| 1111 | ููุฏ | asset | debit |
| 1121 | ุจูู | asset | debit |
| 2141 | ุถุฑูุจุฉ ุงููููุฉ ุงููุถุงูุฉ | liability | credit |
| 4111 | ูุจูุนุงุช ููุฏูุฉ | revenue | credit |
| 4112 | ูุจูุนุงุช ุขุฌูุฉ | revenue | credit |
| 4121 | ูุจูุนุงุช ููุฏูุฉ - Place India | revenue | credit |
| 4122 | ูุจูุนุงุช ุขุฌูุฉ - Place India | revenue | credit |
| 5111 | ูุตุฑููุงุช ุนุงูุฉ | expense | debit |
| 5112 | ูุตุฑููุงุช ุชุดุบูููุฉ | expense | debit |

### 4๏ธโฃ ุจูุงูุงุช ุงููุฑูุน

#### China Town
- ูุจูุนุงุช ููุฏูุฉ: 4111
- ูุจูุนุงุช ุขุฌูุฉ: 4112
- ููุฏ: 1111
- ุจูู: 1121
- ุถุฑูุจุฉ: 2141

#### Place India
- ูุจูุนุงุช ููุฏูุฉ: 4121
- ูุจูุนุงุช ุขุฌูุฉ: 4122
- ููุฏ: 1111
- ุจูู: 1121
- ุถุฑูุจุฉ: 2141

### 5๏ธโฃ ุงูุทุงููุงุช

- **China Town**: 10 ุทุงููุงุช (1-10)
- **Place India**: 10 ุทุงููุงุช (1-10)

## โ ุงูุชุญูู ูู ุงููุฌุงุญ

ุจุนุฏ ุงูุชูููุฐุ ุณุชุญุตู ุนูู ุชูุฑูุฑ ุดุงูู ูุชุถูู:

1. โ ุฌููุน ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ
2. โ ุนุฏุฏ ุงูุตููู ูู ูู ุฌุฏูู
3. โ ุงูุญุณุงุจุงุช ุงูุฃุณุงุณูุฉ
4. โ ุญุณุงุจุงุช ุงููุฑูุน
5. โ ุงูุทุงููุงุช
6. โ ุงูุฃุนูุฏุฉ ูู ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ
7. โ ุงูููุงุชูุญ ุงูุฃุฌูุจูุฉ
8. โ ุงูุชุญูู ูู ุงูุจูุงูุงุช ุงููุทููุจุฉ

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **PostgreSQL ููุท**: ูุง ูุชู ุงุณุชุฎุฏุงู SQLite ุฃู ุฃู ูุงุนุฏุฉ ุจูุงูุงุช ุฃุฎุฑู
2. **ุขูู**: ูุณุชุฎุฏู `ON CONFLICT DO NOTHING` ู `IF NOT EXISTS` ูุชุฌูุจ ุงูุฃุฎุทุงุก
3. **ูุนุงููุงุช**: ุฌููุน ุงูุนูููุงุช ุฏุงุฎู ูุนุงููุฉ ูุงุญุฏุฉ (BEGIN/COMMIT)
4. **ููุงุฑุณ**: ูุชู ุฅูุดุงุก ููุงุฑุณ ูุชุญุณูู ุงูุฃุฏุงุก

## ๐ ุงุณุชุนูุงูุงุช ุงูุชุญูู ุงููุฏููุฉ

### ุงูุชุญูู ูู ุงูุฌุฏุงูู
```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
ORDER BY table_name;
```

### ุงูุชุญูู ูู ุงูุญุณุงุจุงุช
```sql
SELECT account_number, name, type, nature 
FROM accounts 
WHERE account_number IN ('1111', '1121', '2141', '4111', '4112', '4121', '4122')
ORDER BY account_number;
```

### ุงูุชุญูู ูู ุญุณุงุจุงุช ุงููุฑูุน
```sql
SELECT ba.branch_name, ba.account_type, ba.account_number, a.name
FROM branch_accounts ba
LEFT JOIN accounts a ON a.id = ba.account_id
WHERE ba.is_active = true
ORDER BY ba.branch_name, ba.account_type;
```

### ุงูุชุญูู ูู ุงูุทุงููุงุช
```sql
SELECT branch, table_code, status, capacity
FROM pos_tables
WHERE is_active = true
ORDER BY branch, table_code;
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "relation does not exist"
- ุชุฃูุฏ ูู ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุฌูุฏุฉ
- ุชุฃูุฏ ูู ุงูุงุชุตุงู ุงูุตุญูุญ

### ุฎุทุฃ: "duplicate key value"
- ูุฐุง ุทุจูุนู - ุงูุณูุฑูุจุช ูุณุชุฎุฏู `ON CONFLICT DO NOTHING`
- ุงูุจูุงูุงุช ููุฌูุฏุฉ ุจุงููุนู

### ุฎุทุฃ: "permission denied"
- ุชุฃูุฏ ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู
- ูุฏ ุชุญุชุงุฌ ุตูุงุญูุงุช CREATE TABLE

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู ุณุฌูุงุช ุงูุฃุฎุทุงุก
2. ุชุฃูุฏ ูู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
3. ุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู

---

**โ ุจุนุฏ ุงูุชูููุฐ ุงููุงุฌุญุ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุณุชููู ุฌุงูุฒุฉ ุจุงููุงูู ููุนูู ูุน ูุธุงู POS!**
